import spoon.Launcher;
import spoon.reflect.code.CtInvocation;
import spoon.reflect.declaration.CtMethod;
import spoon.reflect.declaration.CtPackage;
import spoon.reflect.declaration.CtType;
import spoon.reflect.factory.Factory;
import spoon.reflect.visitor.filter.TypeFilter;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

public class Analyse  {


    /*
    list1 = methodBody.getElements(new TypeFilter(CtAssignment.class));
     */

    public static void main(String[] args) {
        ArrayList<CtMethod<?>> listMethods = new ArrayList<CtMethod<?>>();
        CtMethod<?> mainMethod = null;

        Launcher spoon = new Launcher();
        spoon.addInputResource("src/main/resources/");
        spoon.run();
        Factory factory = spoon.getFactory();
        // list all packages of the model
       /* for (CtPackage p : factory.Package().getAll()) {
            System.out.println("package: " + p.getQualifiedName());
        }
        // list all classes of the model
        for (CtType<?> s : factory.Class().getAll()) {
            System.out.println("class: " + s.getQualifiedName());
        }*/

        for (CtType<?> s : factory.Class().getAll()) {
            for (CtMethod<?> m : s.getMethods()) {
                listMethods.add(m);
                System.out.println("class: " + s.getQualifiedName() + " method: " + m.getSignature());
            }
        }

        for (CtMethod<?> m : factory.Method().getMainMethods()) {
            mainMethod = m;
            System.out.println("method: " + m.getSignature());
        }

        for (Object m : mainMethod.getBody().getElements(new TypeFilter(CtInvocation.class))){
            System.out.println("invocation : " + m.toString());
        }

    }
      /*  List<String> fileNames = getAllFilesNameFrom("src/main/resources/sma");

        for(String fileName : fileNames){
            //System.out.println(fileName);
        }
    }

    public static Launcher createLauncher() {

        final Launcher launcher = new Launcher();
        launcher.setArgs(new String[] {"--source-classpath","target/classes"});
        launcher.addInputResource("src/main/resources/");
        launcher.buildModel();

        return launcher;

    }

    public static List<String> getAllFilesNameFrom(String path){
        List<String> results = new ArrayList<String>();

        File[] files = new File(path).listFiles();

        for (File file : files) {
            if (file.isFile()){
                    if(file.getName().substring(file.getName().length()-5 , file.getName().length()).equals(".java")) {
                        results.add(file.getName().substring(0, file.getName().length() - 5));
                    }
            } else {
                results.addAll(getAllFilesNameFrom(file.getPath()));
            }
        }
        return results;
    }*/
}
